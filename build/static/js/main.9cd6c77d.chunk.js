(this.webpackJsonpstonks=this.webpackJsonpstonks||[]).push([[0],{120:function(e,t,n){},262:function(e,t,n){"use strict";n.r(t);var c=n(9),r=n(0),s=n.n(r),a=n(10),i=n.n(a),o=(n(119),n(120),n(45)),l=n(29),u=n.n(l),j=n(57),b=n(264),m=function(e){return function(){return function(e,t){var n=Object(r.useState)(e&&e.getValue?e.getValue():null),c=Object(o.a)(n,2),s=c[0],a=c[1];return Object(r.useEffect)((function(){var n=e.subscribe((function(e){a(e),t&&t(e)}));return function(){return n.unsubscribe()}}),[e]),s}(e)}},d={},h=localStorage.getItem("prices");if(h)try{d=JSON.parse(h)}catch(_){console.error(_)}var f=new b.a(d),x=m(f),O=function(){var e=N.getValue();if(e.length){var t={};return e.forEach((function(e){t[e.symbol]=!0})),fetch(new Request("/api/prices/"+Object.keys(t).join(",")+"?t="+(new Date).getTime())).then(function(){var e=Object(j.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.json();case 3:n=e.sent,f.next(n),localStorage.setItem("prices",JSON.stringify(n)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()).catch(console.error)}},p=new b.a(null),g=m(p),y=function(e){if(e)return p.next(null),fetch(new Request("/api/prices/"+e+"?t="+(new Date).getTime())).then(function(){var t=Object(j.a)(u.a.mark((function t(n){var c;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.json();case 3:c=t.sent,p.next(c[e]),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()).catch(console.error)},v=null,k=localStorage.getItem("currencyRates");if(k)try{v=JSON.parse(k)}catch(_){console.error(_)}var C=new b.a(v),S=(m(C),[]),P=localStorage.getItem("stocks");if(P)try{S=JSON.parse(P)}catch(_){console.error(_)}var N=new b.a(S),F=m(N);N.subscribe((function(e){localStorage.setItem("stocks",JSON.stringify(e))}));var z=n(11),w=n(17),I="USD",M=n(59),D=n.n(M);var E=function(e){var t=e.onPageChange,n=F(),r=x(),s=function(e,t){var n=0;return(e||[]).forEach((function(e){if(e&&t&&t[e.symbol]){var c=t[e.symbol],r=+e.buyPrice*+e.amount+(+e.transactionFee||0),s=(c.preMarketPrice||c.postMarketPrice||+c.value)*+e.amount-(+e.transactionFee||0)-r;n+=s}})),n}(n,r),a=D()(),i=D.a.tz(a.format("YYYY-MM-DD")+"T09:30:00","America/New_York"),o=D.a.tz(a.format("YYYY-MM-DD")+"T16:00:00","America/New_York"),l=a.isBefore(i),u=a.isBefore(o),j=i.diff(a,"hour"),b=i.diff(a,"minute"),m=o.diff(a,"hour"),d=o.diff(a,"minute");return Object(c.jsxs)("div",{className:"StockList",children:[Object(c.jsx)(z.f,{mode:"dark",className:"top-bar",leftContent:[Object(c.jsx)(w.d,{size:24,onClick:function(){return t("Menu")}},"menu")],rightContent:[Object(c.jsx)(w.e,{size:24,onClick:function(){return t("StockDetails")}},"plus")],children:"stonks"},"top"),Object(c.jsx)(z.f,{mode:"light",className:"bottom-bar",leftContent:[l?Object(c.jsxs)("div",{className:"text-gray",children:["opens in ",j,"h ",b%60,"m"]},"open"):u?Object(c.jsxs)("div",{className:"text-gray",children:["closes in ",m,"h ",d%60,"m"]},"close"):""],rightContent:[Object(c.jsxs)("div",{className:"text-right "+(s>0?"gain":"lose"),children:[s>0?"+":"",s.toFixed(2)," ",I]},"gain")]},"bottom"),Object(c.jsxs)(z.i,{size:"lg",children:[Object(c.jsx)(z.h,{size:"lg"}),!!r&&(n||[]).map((function(e,n){var s=r[e.symbol]||{},a=s.preMarketPrice||0,i=s.postMarketPrice||0,o=a||i,l=o||s.value||0,u=+e.amount*+e.buyPrice+(+e.transactionFee||0),j=+e.amount*+l-(+e.transactionFee||0),b=+l-+e.buyPrice,m=j-u;return!!r[e.symbol]&&Object(c.jsxs)("div",{children:[Object(c.jsxs)(z.b,{onClick:function(){return t("StockDetails",{item:e,index:n})},children:[Object(c.jsx)(z.b.Header,{title:Object(c.jsxs)(c.Fragment,{children:[e.symbol," ",!o&&l.toFixed(2)," ",!!o&&Object(c.jsx)("span",{className:"market-price",children:l.toFixed(2)}),s.currency]}),extra:Object(c.jsx)("span",{children:e.amount})}),Object(c.jsxs)(z.b.Body,{children:[Object(c.jsxs)("div",{className:"pull-right "+(m>0?"gain":"lose"),children:[m>0?"+":"",m.toFixed(2)," ",s.currency]}),Object(c.jsxs)("div",{className:b>0?"gain":"lose",children:[b>0?"+":"",b.toFixed(2)," ",s.currency," ",b>0?"+":"",(100*b/(+e.buyPrice||1)).toFixed(2),"%"]})]}),Object(c.jsx)(z.b.Footer,{content:"payed ".concat(u.toFixed(2)," ").concat(s.currency),extra:Object(c.jsx)("div",{children:"return ".concat(j.toFixed(2)," ").concat(s.currency)})})]}),Object(c.jsx)(z.h,{size:"lg"})]},n)}))]})]})};var L=function(e){var t=e.onPageChange;return Object(c.jsxs)("div",{className:"Menu",children:[Object(c.jsx)(z.f,{mode:"dark",className:"top-bar",leftContent:[Object(c.jsx)(w.c,{size:24,onClick:function(){return t("StockList")}},"menu")],children:"stonks"}),Object(c.jsx)(z.h,{size:"lg"}),Object(c.jsxs)(z.e,{className:"my-list",children:[Object(c.jsx)(z.e.Item,{onClick:function(){return t("StockList")},children:"My stonks"}),Object(c.jsx)(z.e.Item,{onClick:function(){return t("Summary")},children:"Summary"})]})]})},V=n(61),Y=n(21),q=n(113);var J=Object(q.a)()((function(e){var t=e.values,n=e.onSubmit,s=e.onCancel,a=e.form,i=a.getFieldProps,o=a.getFieldError;Object(r.useEffect)((function(){t&&t.symbol?y(t.symbol).then().catch():p.next(null)}),[!0]);var l=g(),u=function(){var e=a.getFieldValue("symbol");y(e).then().catch()};return Object(c.jsx)("form",{children:Object(c.jsxs)(z.e,{className:"my-list",children:[Object(c.jsx)(z.d,Object(Y.a)(Object(Y.a)({placeholder:"required",error:!!o("symbol")},i("symbol",{initialValue:t.symbol,rules:[{required:!0,message:"Please input symbol"}]})),{},{onChange:function(e){var t=e.toUpperCase();a.setFieldsValue({symbol:t}),u()},onErrorClick:function(){z.g.info(o("symbol").join("\u3001"))},children:"Symbol"})),Object(c.jsx)("small",{className:"stock-name-small",children:l&&l.name}),Object(c.jsx)(z.d,Object(Y.a)(Object(Y.a)({placeholder:"required",error:!!o("amount")},i("amount",{initialValue:t.amount,rules:[{required:!0,message:"Please input amount"}]})),{},{type:"number",onErrorClick:function(){z.g.info(o("amount").join("\u3001"))},children:"Amount"})),Object(c.jsx)(z.d,Object(Y.a)(Object(Y.a)({placeholder:"required",error:!!o("buyPrice")},i("buyPrice",{initialValue:t.buyPrice,rules:[{required:!0,message:"Please input buy price"}]})),{},{type:"digit",extra:l&&l.currency||I,onErrorClick:function(){z.g.info(o("buyPrice").join("\u3001"))},children:"Buy price"})),Object(c.jsx)(z.d,Object(Y.a)(Object(Y.a)({placeholder:""},i("transactionFee",{initialValue:t.transactionFee})),{},{type:"digit",extra:l&&l.currency||I,children:"Transaction fee"})),Object(c.jsx)(z.e.Item,{extra:Object(c.jsx)(z.a,{size:"small",inline:!0,style:{marginLeft:"0.25rem"},onClick:s,children:"Cancel"}),children:Object(c.jsx)(z.a,{type:"primary",size:"small",inline:!0,disabled:!l||!l.value,onClick:function(){return a.validateFields((function(e,t){e||n(a.getFieldsValue())}))},children:"Save"})})]})})}));var T=function(e){var t=e.onPageChange,n=e.props,r=F(),s=n.item,a=n.index,i=function(){return t("StockList")};return Object(c.jsxs)("div",{className:"StockDetails",children:[Object(c.jsx)(z.f,{mode:"dark",className:"top-bar",leftContent:[Object(c.jsx)(w.c,{size:24,onClick:i},"menu")],rightContent:s?[Object(c.jsx)(w.a,{size:24,onClick:function(){if(s&&confirm("Are you sure?")){var e=Object(V.a)(r);e.splice(a,1),N.next(e),i()}}},"menu")]:void 0,children:"stonks"}),Object(c.jsxs)(z.i,{size:"lg",children:[Object(c.jsx)(z.h,{size:"lg"}),Object(c.jsx)(J,{values:s||{},onSubmit:function(e){if(s){var t=Object(V.a)(r);t.splice(a,1,e),N.next(t)}else N.next([].concat(Object(V.a)(r),[e]));O(),i()},onCancel:i})]})]})};var B=function(e){var t=e.onPageChange,n=F(),r=x(),s={},a=0,i=0;n.forEach((function(e){if(e&&r&&r[e.symbol]){s[e.symbol]||(s[e.symbol]={payed:0,gain:0});var t=r[e.symbol],n=+e.buyPrice*+e.amount+(+e.transactionFee||0),c=(t.preMarketPrice||t.postMarketPrice||+t.value)*+e.amount-(+e.transactionFee||0)-n;a+=n,i+=c,s[e.symbol].payed+=n,s[e.symbol].gain+=c}}));var o=[];return Object.keys(s).forEach((function(e){var t=(r||{})[e]||{};o.push({symbol:e,gain:s[e].gain,payed:s[e].payed,currency:t.currency})})),o.push({symbol:"Total",gain:i,payed:a,currency:I}),Object(c.jsxs)("div",{className:"Summary",children:[Object(c.jsx)(z.f,{mode:"dark",className:"top-bar",leftContent:[Object(c.jsx)(w.b,{size:24,onClick:function(){return t("StockList")}},"menu")],children:"stonks"}),Object(c.jsxs)(z.i,{size:"lg",children:[Object(c.jsx)(z.h,{size:"lg"}),Object(c.jsxs)(z.c,{children:[Object(c.jsx)(z.c.Item,{children:Object(c.jsx)("b",{children:"Symbol"})}),Object(c.jsx)(z.c.Item,{children:Object(c.jsx)("b",{children:"Payed"})}),Object(c.jsx)(z.c.Item,{className:"text-right",children:Object(c.jsx)("b",{children:"Gain"})})]}),o.map((function(e){return Object(c.jsxs)("div",{children:[Object(c.jsx)(z.h,{size:"lg"}),Object(c.jsxs)(z.c,{children:[Object(c.jsx)(z.c.Item,{children:e.symbol}),Object(c.jsxs)(z.c.Item,{children:[(+e.payed).toFixed(2)," ",e.currency]}),Object(c.jsxs)(z.c.Item,{className:"text-right "+(e.gain>0?"gain":"lose"),children:[+e.gain>0?"+":"",(+e.gain).toFixed(2)," ",e.currency]})]})]},e.symbol)}))]})]})};var R=function(e){var t=e.onPageChange;return Object(c.jsxs)("div",{className:"Settings",children:[Object(c.jsx)(z.f,{mode:"dark",className:"top-bar",leftContent:[Object(c.jsx)(w.b,{size:24,onClick:function(){return t("StockList")}},"menu")],children:"stonks"}),Object(c.jsxs)(z.i,{size:"lg",children:[Object(c.jsx)(z.h,{size:"lg"}),"settings"]})]})};var A=function(){Object(r.useEffect)((function(){O(),fetch(new Request("/api/currencyRates")).then(function(){var e=Object(j.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.json();case 3:n=e.sent,C.next(n),localStorage.setItem("currencyRates",JSON.stringify(n)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()).catch(console.error)}),[!0]);var e=Object(r.useState)("StockList"),t=Object(o.a)(e,2),n=t[0],s=t[1],a=Object(r.useState)({}),i=Object(o.a)(a,2),l=i[0],b=i[1],m=function(e,t){s(e),b(t||{})};return Object(c.jsxs)("div",{className:"App",children:["Menu"===n&&Object(c.jsx)(L,{onPageChange:m,props:l}),"StockList"===n&&Object(c.jsx)(E,{onPageChange:m,props:l}),"StockDetails"===n&&Object(c.jsx)(T,{onPageChange:m,props:l}),"Summary"===n&&Object(c.jsx)(B,{onPageChange:m,props:l}),"Settings"===n&&Object(c.jsx)(R,{onPageChange:m,props:l})]})},U=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,265)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,s=t.getLCP,a=t.getTTFB;n(e),c(e),r(e),s(e),a(e)}))};i.a.render(Object(c.jsx)(s.a.StrictMode,{children:Object(c.jsx)(A,{})}),document.getElementById("root")),U()}},[[262,1,2]]]);
//# sourceMappingURL=main.9cd6c77d.chunk.js.map